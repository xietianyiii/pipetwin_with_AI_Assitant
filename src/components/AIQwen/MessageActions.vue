<template>
  <div class="actions">
    <!-- 复制 -->
    <button class="action-btn" @click="onCopy" title="复制内容">
      <svg
        t="1766387467649"
        class="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="6039"
        width="16"
        height="16"
      >
        <path
          d="M753.312 698.848 753.312 383.6736c0-62.048-50.3104-112.3264-112.288-112.3264L395.3024 271.3472 324.288 271.3472l-53.7344 0-29.536 0c-62.048 0-112.288 50.272-112.288 112.3264l0 400.0512c0 61.9776 50.24 112.2752 112.288 112.2752l400.0128 0c62.048 0 112.288-50.2976 112.288-112.2752l0-31.0656 0.8768 0 0-54.0352C753.888 698.624 753.6768 698.7776 753.312 698.848zM660.6016 681.728l0 42.5984c0 0.864-0.2368 1.792-0.2368 2.6688-1.4272 42.3552-36.064 76.3008-78.7328 76.3008L300.3392 803.296c-43.5968 0-78.9056-35.3664-78.9056-78.9696L221.4336 442.9888c0-42.2336 33.2608-76.4928 75.0144-78.5984 1.2928-0.064 2.5984-0.3712 3.8912-0.3712l41.4272 0L581.632 364.0192c43.6608 0 78.9696 35.4048 78.9696 78.9696L660.6016 681.728zM895.1232 555.5008 895.1232 240.3264c0-62.048-50.3104-112.3264-112.288-112.3264L537.1136 128 466.0992 128l-53.7344 0-29.536 0c-62.048 0-112.288 50.272-112.288 112.3264l0 4.4736 115.0784 0c13.4912-13.8112 32.0256-22.72 52.6464-23.7568 1.2864-0.064 2.592-0.3712 3.8848-0.3712l41.4272 0 239.8656 0c43.6608 0 78.9696 35.4048 78.9696 78.9696l0 238.7328 0 42.5984c0 0.864-0.2368 1.792-0.2368 2.6688-0.8768 25.9136-14.208 48.6336-34.176 62.4l0 106.6048 14.8352 0c62.048 0 112.288-50.2976 112.288-112.2752l0-31.0656L896 609.3056l0-54.0352C895.6992 555.2768 895.488 555.424 895.1232 555.5008z"
          fill="#cdcdcd"
          p-id="6040"
        ></path>
      </svg>
    </button>

    <!-- 重新生成（只对 AI 消息显示） -->
    <button
      v-if="canRegenerate"
      class="action-btn"
      @click="$emit('regenerate')"
      title="重新生成"
    >
      <svg
        t="1766388494327"
        class="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="9481"
        width="16"
        height="16"
      >
        <path
          d="M512 928.914286c-146.285714 0-285.257143-73.142857-365.714286-212.114286l-7.314285-14.628571c-14.628571-29.257143-7.314286-58.514286 21.942857-73.142858 29.257143-14.628571 58.514286-7.314286 73.142857 21.942858l7.314286 21.942857c87.771429 146.285714 270.628571 197.485714 416.914285 109.714285 87.771429-51.2 138.971429-138.971429 153.6-234.057142 0-29.257143 29.257143-51.2 58.514286-51.2s51.2 29.257143 51.2 58.514285c-14.628571 131.657143-87.771429 248.685714-204.8 314.514286-58.514286 43.885714-131.657143 58.514286-204.8 58.514286zM153.6 526.628571c-7.314286 0-7.314286 0 0 0-36.571429 0-58.514286-29.257143-51.2-58.514285 7.314286-131.657143 87.771429-248.685714 197.485714-314.514286 95.085714-58.514286 212.114286-73.142857 314.514286-43.885714 109.714286 29.257143 197.485714 95.085714 256 197.485714l7.314286 21.942857c14.628571 29.257143 7.314286 58.514286-21.942857 73.142857-29.257143 14.628571-58.514286 7.314286-73.142858-21.942857l-7.314285-21.942857c-87.771429-146.285714-270.628571-197.485714-416.914286-109.714286C270.628571 292.571429 219.428571 380.342857 204.8 482.742857c0 21.942857-29.257143 43.885714-51.2 43.885714z"
          fill="#cdcdcd"
          p-id="9482"
        ></path>
        <path
          d="M146.285714 826.514286h-14.628571c-29.257143-7.314286-43.885714-36.571429-36.571429-65.828572l29.257143-117.028571c7.314286-29.257143 36.571429-43.885714 65.828572-36.571429l117.028571 29.257143c29.257143 7.314286 43.885714 36.571429 36.571429 65.828572s-36.571429 43.885714-65.828572 36.571428L219.428571 724.114286l-14.628571 65.828571c-7.314286 21.942857-29.257143 36.571429-58.514286 36.571429zM841.142857 424.228571h-14.628571l-117.028572-29.257142c-29.257143-14.628571-43.885714-43.885714-36.571428-73.142858 7.314286-29.257143 36.571429-43.885714 65.828571-36.571428l65.828572 14.628571 14.628571-65.828571c7.314286-29.257143 36.571429-43.885714 65.828571-36.571429 29.257143 7.314286 43.885714 36.571429 36.571429 65.828572l-29.257143 117.028571c0 29.257143-21.942857 43.885714-51.2 43.885714z"
          fill="#cdcdcd"
          p-id="9483"
        ></path>
      </svg>
    </button>

    <button
      class="action-btn"
      :class="{ active: isSpeaking }"
      @click="$emit('speak')"
      title="语音朗读"
    >
      <svg
        t="1766388850105"
        class="icon"
        viewBox="0 0 1419 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="20722"
        width="16"
        height="16"
      >
        <path
          d="M744.856806 26.144038C695.742284-6.908416 636.200371-8.721876 585.553044 21.286558L330.35183 172.451341H151.100017C67.788835 172.451341 0 248.249621 0 341.405296v341.167819c0 93.177264 67.788835 168.953955 151.121606 168.953955h179.230224l255.201214 151.164784c23.985158 14.205431 49.956485 21.264969 75.884635 21.264968 28.821049 0 57.577332-8.743464 83.419127-26.144037 49.114522-33.052454 78.410525-91.018384 78.410524-155.115534V181.237983c0-64.075561-29.317591-122.06308-78.410524-155.115534z m-51.100692 816.617979c0 18.480013-10.967111 27.849553-15.673469 31.023107-4.727947 3.173554-17.271041 9.628605-31.86507 0.971496l-269.730478-159.778715c-11.118232-6.584584-23.164783-9.17524-34.865913-8.246922H151.143194c-11.895429 0-21.588801-10.815989-21.5888-24.136279V341.426885c0-13.32029 9.693372-24.136279 21.5888-24.13628h190.47799c11.70113 0.928318 23.747681-1.662338 34.865913-8.246921l269.730478-159.778715c14.594029-8.657109 27.137123-2.202058 31.86507 0.971496 4.706359 3.173554 15.673469 12.543093 15.673469 31.023107v661.524034zM1419.463653 502.177096v-0.345421-0.345421c-0.323832-189.873503-92.464834-365.649519-240.628774-458.89155-28.583572-17.983471-64.766402-6.670939-80.850059 25.280486-16.083657 31.951425-5.958509 72.430427 22.625064 90.413898 111.031203 69.861359 180.02901 201.617811 180.136954 343.888008-0.107944 142.270197-69.105751 274.00506-180.136954 343.888008-28.583572 17.983471-38.687131 58.462473-22.625064 90.413898 10.902344 21.653567 31.044696 33.829651 51.791534 33.82965 9.866082 0 19.861697-2.763367 29.058525-8.549165 148.16394-93.242031 240.304942-269.018047 240.628774-458.89155v-0.345421-0.34542z"
          p-id="20723"
          fill="#cdcdcd"
        ></path>
        <path
          d="M1208.411537 502.781582v-0.734019-0.172711-0.17271-0.734019c-0.345421-112.304942-54.878732-216.233429-142.529263-271.392815-28.583572-17.983471-64.766402-6.670939-80.850059 25.280486-16.083657 31.951425-5.958509 72.430427 22.625063 90.413897 50.560971 31.821892 81.994265 91.81717 82.059032 156.605161-0.064766 64.787991-31.476472 124.76168-82.059032 156.605161-28.583572 17.983471-38.687131 58.462473-22.603475 90.392309 10.902344 21.653567 31.044696 33.829651 51.791533 33.829651 9.866082 0 19.861697-2.741778 29.058526-8.549165 87.650531-55.159386 142.183842-159.066284 142.529263-271.392815z"
          p-id="20724"
          fill="#cdcdcd"
        ></path>
      </svg>
    </button>

    <button
      class="action-btn"
      :class="{ active: feedback === 'up' }"
      @click="handleUpvote"
      title="答的不错"
    >
      <Transition name="icon-fade" mode="out-in">
        <svg
          v-if="!isUpIcon"
          t="1766389009309"
          class="icon"
          viewBox="0 0 1064 1024"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg"
          p-id="33497"
          width="16"
          height="16"
        >
          <path
            d="M204.8 440.32a30.72 30.72 0 0 0-30.72 30.72v368.64c0 16.95744 13.76256 30.72 30.72 30.72h51.2v-430.08H204.8z m-133.12 30.72A133.12 133.12 0 0 1 204.8 337.92h102.4c28.2624 0 51.2 22.9376 51.2 51.2v532.48c0 28.2624-22.9376 51.2-51.2 51.2H204.8a133.12 133.12 0 0 1-133.12-133.12v-368.64z"
            fill="#cdcdcd"
            p-id="33498"
          ></path>
          <path
            d="M512.94208 140.41088c-23.18336 71.35232-57.42592 138.89536-89.45664 190.0544-16.384 26.17344-32.80896 48.98816-47.59552 66.31424-7.3728 8.6016-14.99136 16.62976-22.65088 23.26528-6.10304 5.24288-18.0224 14.82752-33.5872 18.75968a51.2 51.2 0 0 1-33.01376-96.58368c2.4576-2.12992 6.26688-5.98016 11.38688-12.00128 10.6496-12.45184 24.1664-30.88384 38.66624-54.14912 29.12256-46.4896 60.2112-108.29824 80.32256-171.86816 7.08608-22.28224 23.7568-45.99808 52.18304-56.89344 47.5136-18.18624 125.7472-27.27936 172.60544 40.50944 21.01248 30.43328 30.22848 70.41024 30.3104 117.30944 0.08192 32.11264-4.096 69.30432-12.98432 112.31232h167.1168c46.61248 0 101.82656 19.0464 130.37568 70.8608 60.66176 110.01856 85.1968 302.4896-81.79712 521.17504-32.31744 42.27072-82.3296 63.32416-131.8912 63.32416H307.2a51.2 51.2 0 1 1 0-102.4h435.77344c21.34016 0 39.7312-9.0112 50.46272-23.10144 142.9504-187.14624 114.11456-335.91296 73.5232-409.6-4.87424-8.8064-18.0224-17.85856-40.67328-17.85856H593.92a51.2 51.2 0 0 1-49.31584-64.9216c18.432-66.27328 25.1904-114.85184 25.14944-149.54496-0.08192-35.06176-7.168-52.0192-12.20608-59.35104-4.99712-7.20896-16.67072-14.58176-44.60544-5.61152zM284.672 343.81824l0.69632-0.49152a4.096 4.096 0 0 1-0.69632 0.49152z"
            fill="#cdcdcd"
            p-id="33499"
          ></path>
        </svg>

        <svg
          v-else
          t="1766395383550"
          class="icon"
          viewBox="0 0 1024 1024"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg"
          p-id="54681"
          width="16"
          height="16"
        >
          <path
            d="M844.231111 391.39555600000006H659.9111109999999c-13.653333-2.275556-18.204444-15.928889-20.48-22.755556V202.52444400000002c0-45.511111-36.408889-81.92-81.92-81.92-40.96 0-75.093333 31.857778-81.92 70.542223-25.031111 157.013333-120.604444 209.351111-182.044444 225.28 2.275556 6.826667 2.275556 11.377778 2.275555 15.928889v441.457777c0 9.102222-2.275556 18.204444-6.826666 27.306666999999997h446.008888c43.235556-9.102222 72.817778-25.031111 93.297778-68.266667l93.297778-327.68c18.204444-59.16444400000001-11.377778-116.053333-77.368889-113.77777699999999zM257.137778 876.0888889999999V432.355556c0-13.653333-18.204444-25.031111-38.684445-25.031112H157.013333c-31.857778 0-59.16444400000001 27.306666999999997-59.16444400000001 59.16444500000001v373.191111c0 34.133333 25.031111 61.44 59.16444400000001 61.44h61.44c20.48 0 38.684444-11.377778 38.684445-25.031111z m0 0"
            fill="#cdcdcd"
            p-id="54682"
          ></path>
        </svg>
      </Transition>
    </button>

    <button
      class="action-btn"
      :class="{ active: feedback === 'down' }"
      @click="handleDownvote"
      title="答的不好"
    >
      <svg
        v-if="!isDownIcon"
        t="1766389505247"
        class="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="37332"
        width="17.5"
        height="17.5"
      >
        <path
          d="M360 640C420.992 680.106667 448 727.381333 448 789.333333c0 5.610667 0.426667 12.864 1.578667 21.461334a174.933333 174.933333 0 0 0 11.2 42.666666c19.584 48.192 60.864 83.008 119.018666 85.12 28.842667 2.56 60.885333-3.584 91.413334-25.045333 58.709333-41.237333 81.706667-117.248 69.973333-230.869333H789.333333v-42.666667 42.666667c17.173333 0 38.4-2.474667 61.824-10.666667 66.304-23.125333 107.626667-84.117333 84.928-162.816l-53.674666-254.549333A213.333333 213.333333 0 0 0 673.664 85.333333H207.018667a85.333333 85.333333 0 0 0-85.077334 78.784l-29.546666 384A85.333333 85.333333 0 0 0 177.493333 640h182.506667zM298.666667 530.666667V554.666667H177.493333L207.018667 170.666667H298.666667v360zM384 170.666667h289.664a128 128 0 0 1 125.226667 101.589333L853.333333 530.325333C874.666667 597.333333 789.333333 597.333333 789.333333 597.333333h-149.333333c64 277.333333-54.613333 256-54.613333 256C533.333333 853.333333 533.333333 789.333333 533.333333 789.333333c0-92.8-43.264-167.082667-129.770666-222.805333A42.666667 42.666667 0 0 1 384 530.666667V170.666667z"
          fill="#cdcdcd"
          p-id="37333"
        ></path>
      </svg>

      <svg
        v-else
        t="1766395298700"
        class="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="52691"
        width="17.5"
        height="17.5"
      >
        <path
          d="M640 682.688h102.592a170.624 170.624 0 0 0 167.936-201.216l-38.784-213.376A170.688 170.688 0 0 0 703.872 128H341.312v512l77.696 246.976c12.672 29.44 45.248 56.128 86.4 48.256 65.216-12.544 134.592-63.424 134.592-145.92v-106.624zM256 640a128 128 0 0 1-128-128V256a128 128 0 0 1 128-128v512z"
          p-id="52692"
          fill="#cdcdcd"
        ></path>
      </svg>
    </button>
  </div>
</template>

<script setup lang="ts">
import { ref } from "vue";

const isUpIcon = ref(false);
const isDownIcon = ref(false);

const props = defineProps<{
  content: string;
  canRegenerate: boolean;
  isSpeaking: boolean;
  feedback?: "up" | "down" | null;
}>();

const emit = defineEmits<{
  (e: "regenerate"): void;
  (e: "speak"): void;
  (e: "feedback", payload: { type: "up" | "down" }): void;
}>();

function onCopy() {
  if (!props.content) return;
  navigator.clipboard.writeText(props.content);
}

function handleUpvote() {
  // 这里可以添加其他操作
  isUpIcon.value = !isUpIcon.value;
  emit("feedback", { type: "up" });
}

function handleDownvote() {
  // 这里可以添加其他操作
  isDownIcon.value = !isDownIcon.value;
  emit("feedback", { type: "down" });
}
</script>

<script lang="ts">
export default {
  name: "MessageActions",
};
</script>

<style scoped>
.actions {
  display: flex;
  gap: 6px;
  margin-top: 4px;
  transition: opacity 0.2s;
}

.msg:hover .actions {
  opacity: 1;
}

.action-btn {
  border: none;
  background: transparent;
  color: #fff;
  font-size: 12px;
  padding: 4px 6px;
  border-radius: 6px;
  cursor: pointer;
}

.action-btn:hover {
  background: rgba(0, 191, 255, 0.25);
}

.icon-fade-enter-active,
.icon-fade-leave-active {
  transition: opacity 0.1s ease, transform 0.1s ease;
}

.icon-fade-enter-from,
.icon-fade-leave-to {
  opacity: 0;
  transform: scale(0.9);
}

.icon-fade-enter-to,
.icon-fade-leave-from {
  opacity: 1;
  transform: scale(1);
}

</style>
